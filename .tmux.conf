# Change prefix to Ctrl-a
set -g prefix C-a
unbind C-b
bind C-a send-prefix

# Reload config
bind r source-file ~/.tmux.conf \; display-message "tmux reloaded"

# Global options
set -g base-index 1           # Start window numbering at 1
set -g pane-base-index 1      # Start pane numbering at 1
set-window-option -g pane-base-index 1
set-option -g renumber-windows on

set-option -g status-position top
set -g set-clipboard on
set -g detach-on-destroy off

# Mouse support
set -g mouse on

# Vi keys
setw -g mode-keys vi
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "pbcopy"

# Easy pane movement (works with vim-tmux-navigator, no prefix)
bind -n C-h select-pane -L
bind -n C-j select-pane -D
bind -n C-k select-pane -U
bind -n C-l select-pane -R

# Window & Pane management
bind \\ split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
bind C-a last-window  # Double tap prefix to toggle last window
bind x kill-pane      # Kill pane without confirmation
bind & confirm-before -p "kill-window #W? (y/n)" kill-window # Kill window with confirmation
bind $ command-prompt -I "#S" "rename-session '%%'" # Rename session with prompt
bind Tab switch-client -l                           # Switch to last session

# --- Themes ---
# Load the currently selected theme
source-file ~/.tmux.theme.conf

# Theme Switcher Menu (Prefix + T)
bind T display-menu -T "Switch Theme" \
    "Catppuccin"  c "run-shell '~/dotfiles/scripts/tmux-switch-theme.sh catppuccin'" \
    "Dracula"     d "run-shell '~/dotfiles/scripts/tmux-switch-theme.sh dracula'" \
    "Nord"        n "run-shell '~/dotfiles/scripts/tmux-switch-theme.sh nord'" \
    "Rose Pine"   r "run-shell '~/dotfiles/scripts/tmux-switch-theme.sh rose-pine'" \
    "Gruvbox"     g "run-shell '~/dotfiles/scripts/tmux-switch-theme.sh gruvbox'" \
    "Tokyo Night" t "run-shell '~/dotfiles/scripts/tmux-switch-theme.sh tokyo-night'" \
    "GitHub Dark" h "run-shell '~/dotfiles/scripts/tmux-switch-theme.sh github-dark'"

# --- Plugins ---
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'
set -g @plugin 'alexwforsythe/tmux-which-key'

# Config for plugins
set -g @resurrect-strategy-nvim 'session' # Restore Neovim sessions

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'

# Force mauve highlight for current window number only (override plugin defaults)
set -g window-status-current-format "#[fg=#303446,bg=#ca9ee6,bold] #I #[fg=#c6d0f5,bg=#303446] #W "
set -g window-status-format "#[fg=#c6d0f5,bg=#51576d] #I #[fg=#c6d0f5,bg=#303446] #W "
